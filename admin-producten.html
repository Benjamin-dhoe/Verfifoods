<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>admin</title>
  <meta content="admin" property="og:title">
  <meta content="admin" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="/css/verfifoods-4d83b7.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://use.typekit.net/nnx8vsx.js" type="text/javascript"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="/images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="/images/webclip.png" rel="apple-touch-icon">
  <link rel="stylesheet" href="https://use.typekit.net/nnx8vsx.css">
</head>
<body class="body">
  <div id="popupeditproduct" class="popupholder">
    <div class="popupcontainer vis">
        <div class="closebtn" id="closepopupeditproduct">X</div>
        <div class="leftalignflexvert" editparts="1">
            <label class="brownundertitle">naam PRODUCT (NL)</label>
            <input class="text-field w-input" maxlength="256" placeholder="" type="text" id="editnaamNL">
            <label class="brownundertitle">Beschrijving (NL)</label>
            <textarea placeholder="" maxlength="5000" id="editbeschrijvingNL" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
                <button class="button intypeholder notabs w-button" nexteditpart>Volgende</button>
            </div>
        </div>
        <div class="leftalignflexvert inv" editparts="2">
            <label class="brownundertitle">naam PRODUCT (FR)</label>
            <input class="text-field w-input" maxlength="256" placeholder="" type="text" id="editnaamFR">
            <label class="brownundertitle">Beschrijving (FR)</label>
            <textarea placeholder="" maxlength="5000" id="editbeschrijvingFR" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
                <button class="button intypeholder notabs grey w-button" preveditpart>Vorige</button>
                <button class="button intypeholder notabs w-button" nexteditpart>Volgende</button>
            </div>
        </div>
        <div class="leftalignflexvert inv" editparts="3">
            <label class="brownundertitle">naam PRODUCT (EN)</label>
            <input class="text-field w-input" maxlength="256" placeholder="" type="text" id="editnaamEN">
            <label class="brownundertitle">Beschrijving (EN)</label>
            <textarea placeholder="" maxlength="5000" id="editbeschrijvingEN" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
                <button class="button intypeholder notabs grey w-button" preveditpart>Vorige</button>
                <button class="button intypeholder notabs w-button" nexteditpart>Volgende</button>
            </div>
        </div>
        <div class="leftalignflexvert inv" editparts="4">
            <label class="brownundertitle">Prijs</label>
            <select class="text-field w-input" id="edittype" required>
                <option value="" disabled>Selecteer type</option>
                <option value="w7UDUqdHkQcNItRH7Dx6">Brood</option>
                <option value="W2II8fhgeqnAC0mNbzCP">Viennoiserie</option>
                <option value="8QZfIQ8c4ap8SmkvJIMx">Stokbrood</option>
                <option value="q6xYExbEJ4PQTGgWnPBN">Gebak</option>
                <option value="FhNpS4oxqM1mc6ikaGCl">Ijsjes</option>
                <option value="q3Tu4CvuARtHeLtSp3z8">Smoothies</option>
            </select>
            <label class="brownundertitle">Afbeelding</label>
            <input type="file" id="editFileInput" style="width: 90%; padding-bottom: 20px;">
            <img id="currentImage" src="" style="width: 100px; height: 100px; display: none;">
            <label class="brownundertitle">Prijs</label>
            <input class="text-field w-input" maxlength="256" placeholder="" type="number" id="editprijs" required="">
            <label for="Aantal" class="brownundertitle">Aantal stuks per doos</label>
            <input class="text-field w-input" maxlength="256" placeholder="" type="number" id="editaantal" required="">
            <label class="brownundertitle">Specificaties</label>
            <div class="alwaysflexhorizontal">
                <div class="iconspecs"><img src="/images/weight-kg.svg" loading="lazy" alt=""></div>
                <input class="noclass w-input" maxlength="256" placeholder="in gram" type="number" id="editgewicht" required>
            </div>
            <div class="alwaysflexhorizontal">
                <div class="iconspecs"><img src="/images/time.svg" loading="lazy" alt=""></div>
                <input class="noclass w-input" maxlength="256" name="tijd" data-name="tijd" placeholder="in minuten" type="number" id="edittijd" required>
            </div>
            <div class="alwaysflexhorizontal">
                <div class="iconspecs"><img src="/images/temperature.svg" loading="lazy" width="18" alt=""></div>
                <input class="noclass w-input" maxlength="256" placeholder="in graden" type="number" id="edittemperatuur" required>
            </div>
            <div class="alwaysflexhorizontal">
                <div class="iconspecs"><img src="/images/753124_microwave_oven_cook_cooking_kitchen_icon.svg" loading="lazy" alt=""></div>
                <input class="noclass w-input" maxlength="256" placeholder="in graden" type="number" id="editoventemperatuur" required>
            </div>
            <div class="alwaysflexhorizontal nextprev">
                <button class="button intypeholder notabs grey w-button" preveditpart>Vorige</button>
                <button class="button intypeholder notabs w-button" onclick="updateProduct()">Product bijwerken</button>
            </div>
            <div class="loading" id="producteditloading">
                <lottie-player
                    src="/images/loading.json"
                    background="transparent"
                    speed="1"
                    loop
                    autoplay>
                </lottie-player>
            </div>
            <div id="editProgressText" style="margin-top: 5px; font-size: 14px; display: none;"></div>
        </div>
    </div>
</div>
  <div id="popupdeleteproduct" class="popupholder">
    <div class="popupcontainer vis">
        <div class="closebtn" id="closepopupdeleteproduct">X</div>
        <div id="confirmDeleteBox"></div>
    </div>
</div>
  <div id="popupaddproduct" class="popupholder">
    <div class="popupcontainer vis">
        <div class="closebtn" id="closepopupaddproduct">X</div>
          <div class="leftalignflexvert" addparts="1"><label class="brownundertitle">naam PRODUCT (NL)</label><input class="text-field w-input" maxlength="256" placeholder="" type="text" id="naamnewNL"><label class="brownundertitle">Beschrijving (NL)</label><textarea placeholder="" maxlength="5000" id="beschrijvingnewNL" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
              <button class="button intypeholder notabs w-button" nextpart>Volgende</button>
            </div>
          </div>
          <div class="leftalignflexvert inv" addparts="2"><label class="brownundertitle">naam PRODUCT (FR)</label><input class="text-field w-input" maxlength="256" placeholder="" type="text" id="naamnewFR"><label class="brownundertitle">Beschrijving (FR)</label><textarea placeholder="" maxlength="5000" id="beschrijvingnewFR" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
              <button class="button intypeholder notabs grey w-button" prevpart>Vorige</button>
              <button class="button intypeholder notabs w-button" nextpart>Volgende</button>
            </div>
          </div>
          <div class="leftalignflexvert inv" addparts="3"><label class="brownundertitle">naam PRODUCT (EN)</label><input class="text-field w-input" maxlength="256" placeholder="" type="text" id="naamnewEN"><label class="brownundertitle">Beschrijving (EN)</label><textarea placeholder="" maxlength="5000" id="beschrijvingnewEN" class="textarea w-input"></textarea>
            <div class="alwaysflexhorizontal nextprev">
              <button class="button intypeholder notabs grey w-button" prevpart>Vorige</button>
              <button class="button intypeholder notabs w-button" nextpart>Volgende</button>
            </div>
          </div>
          <div class="leftalignflexvert inv" addparts="4">
            <label class="brownundertitle">Prijs</label>
            <select class="text-field w-input" id="typenew" required>
              <option value="" disabled selected>Selecteer type</option>
              <option value="w7UDUqdHkQcNItRH7Dx6">Brood</option>
              <option value="W2II8fhgeqnAC0mNbzCP">Viennoiserie</option>
              <option value="8QZfIQ8c4ap8SmkvJIMx">Stokbrood</option>
              <option value="q6xYExbEJ4PQTGgWnPBN">Gebak</option>
              <option value="FhNpS4oxqM1mc6ikaGCl">Ijsjes</option>
              <option value="q3Tu4CvuARtHeLtSp3z8">Smoothies</option>
            </select>
            <label class="brownundertitle">Afbeelding</label>
            <input type="file" id="fileInput" style="
              width: 90%;
              padding-bottom: 20px;
            ">
            <label class="brownundertitle">Prijs</label><input class="text-field w-input" maxlength="256" placeholder="" type="number" id="prijsnew" required="">
            <label for="Aantal" class="brownundertitle">Aantal stuks per doos</label><input class="text-field w-input" maxlength="256" placeholder="" type="number" id="aantalnew" required=""><label class="brownundertitle">Specificaties</label>
            <div class="alwaysflexhorizontal">
              <div class="iconspecs"><img src="/images/weight-kg.svg" loading="lazy" alt=""></div><input class="noclass w-input" maxlength="256" placeholder="in gram" type="number" id="gewichtnew" required>
            </div>
            <div class="alwaysflexhorizontal">
              <div class="iconspecs"><img src="/images/time.svg" loading="lazy" alt=""></div><input class="noclass w-input" maxlength="256" name="tijd" data-name="tijd" placeholder="in minuten" type="number" id="tijdnew" required>
            </div>
            <div class="alwaysflexhorizontal">
              <div class="iconspecs"><img src="/images/temperature.svg" loading="lazy" width="18" alt=""></div><input class="noclass w-input" maxlength="256" placeholder="in graden" type="number" id="temperatuurnew" required>
            </div>
            <div class="alwaysflexhorizontal">
              <div class="iconspecs"><img src="/images/753124_microwave_oven_cook_cooking_kitchen_icon.svg" loading="lazy" alt=""></div><input class="noclass w-input" maxlength="256" placeholder="in graden" type="number" id="oventemperatuurnew" required>
            </div>
            <div class="alwaysflexhorizontal nextprev">
              <button class="button intypeholder notabs grey w-button" prevpart>Vorige</button>
              <button class="button intypeholder notabs w-button" onclick="addProduct()">Product toevoegen</button>
            </div>
            <div class="loading" id="productaddloading">
              <lottie-player
                src="/images/loading.json"
                background="transparent"
                speed="1"
                loop
                autoplay>
              </lottie-player>
            </div>
            <div id="progressText" style="margin-top: 5px; font-size: 14px; display: none;"></div>
          </div>
    </div>
  </div>
  <div class="_100-widthcenter">
    <div class="containcenter dashboard">
      <div class="holdertopdashboard">
        <a href="/index.html" class="w-inline-block"><img src="images/logo-Verfifoods.png" loading="lazy" width="120" alt=""></a>
        <div class="brownundertitle">Admin</div>
      </div>
      <div class="holderdashboardcontent">
        <div class="holderlinksdashboard">
          <a href="/admin/bestellingen" class="mapslink _10down">
            <div class="typefoodicon dash"><img src="/images/8726224_shopping_cart_icon.svg" loading="lazy" alt=""></div>
            <div class="brownundertitle blue">Bestellingen</div>
          </a>
          <a href="/admin/klanten" class="mapslink _10down">
            <div class="typefoodicon dash"><img src="/images/usericon.svg" loading="lazy" alt=""></div>
            <div class="brownundertitle blue">Klanten</div>
          </a>
          <a href="/admin/producten" class="mapslink _10down">
            <div class="typefoodicon dash"><img src="/images/listicon.svg" loading="lazy" alt=""></div>
            <div class="brownundertitle bold-text">Producten</div>
          </a>
          <a href="/admin/leveranciers" class="mapslink _10down">
            <div class="typefoodicon dash"><img src="/images/breadicon.svg" loading="lazy" alt=""></div>
            <div class="brownundertitle blue">Leveranciers</div>
          </a>
        </div>
        <div class="holderappdashboard">
          <div class="holderapptop">
            <div class="mapslink _10down">
              <div class="typefoodicon dash"><img src="/images/listicon.svg" loading="lazy" alt=""></div>
              <div class="brownundertitle bold-text">Producten</div>
            </div>
            <img src="/images/filterIcon.svg" loading="lazy" alt="" class="menuicon" opensidemenu>
          </div>
          <div class="holderappresults" id="holderProducts">
            <div class="holderthumbnailproduct dashboard newadd" id="addproductbtn">
              <div class="button intypeholder w-button">Nieuw product </div>
              <div class="plussign">+</div>
          </div>
          <div class="loading vis" id="productsloading">
              <lottie-player
                src="/images/loading.json"
                background="transparent"
                speed="1"
                loop
                autoplay>
              </lottie-player>
            </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=66d843f7aa41c71a1134cb81" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="/js/dash-aanbod.js" type="text/javascript"></script>
  <script type="module">
  // Import Firebase SDK and initialize the app
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
  import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-storage.js";
  import { getFirestore, collection, addDoc, getDocs, getDoc, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

  // Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCIQlfqz-Hd-Oe0tNjnEfJdwHwMy3JuNr4",
    authDomain: "test-9efbe.firebaseapp.com",
    projectId: "test-9efbe",
    storageBucket: "test-9efbe.appspot.com",
    messagingSenderId: "218327249026",
    appId: "1:218327249026:web:0d48fa588ac45ef557049b",
    measurementId: "G-2ZTZCL27TE"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const storage = getStorage(app);
  const db = getFirestore(app);
  const auth = getAuth(app);

  function checkAuth() {
    onAuthStateChanged(auth, (user) => {
      if (user) {
        console.log("User is logged in:", user);
      } else {
        console.log("No user is logged in");
      }
    });
  }

  window.onload = function() {
    checkAuth();
    displayProducts();
  };

  // Function to add product to Firestore and Storage
  window.addProduct = async function addProduct() {
    const naamNL = document.getElementById('naamnewNL').value;
    const beschrijvingNL = document.getElementById('beschrijvingnewNL').value;
    const naamFR = document.getElementById('naamnewFR').value;
    const beschrijvingFR = document.getElementById('beschrijvingnewFR').value;
    const naamEN = document.getElementById('naamnewEN').value;
    const beschrijvingEN = document.getElementById('beschrijvingnewEN').value;
    const prijs = document.getElementById('prijsnew').value;
    const aantal = document.getElementById('aantalnew').value;
    const gewicht = document.getElementById('gewichtnew').value;
    const tijd = document.getElementById('tijdnew').value;
    const temperatuur = document.getElementById('temperatuurnew').value;
    const ovenTemp = document.getElementById('oventemperatuurnew').value;
    const fileInput = document.getElementById('fileInput');
    const type = document.getElementById('typenew').value;
    const file = fileInput.files[0];
    const progressText = document.getElementById('progressText');
    const productAddLoading = document.getElementById('productaddloading');

    if (!file) {
      alert("Please select an image to upload.");
      return;
    }

    if (!naamNL) {
      alert("Please enter the product name in Dutch.");
      return;
    }

    progressText.style.display = 'block';
    productAddLoading.style.display = 'block';
    progressText.innerHTML = '0%';

    const storageRef = ref(storage, 'producten/' + file.name);
    const uploadTask = uploadBytesResumable(storageRef, file);

    try {
      uploadTask.on('state_changed',
        (snapshot) => {
          const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          progressText.innerHTML = 'Opladen: ' + Math.round(progress) + '%';
        },
        (error) => {
          console.error('Upload failed', error);
          alert('Upload failed: ' + error.message);
        },
        async () => {
          const downloadURL = await getDownloadURL(uploadTask.snapshot.ref);
          console.log('File available at', downloadURL);

          await addDoc(collection(db, "Producten"), {
            naamNL,
            beschrijvingNL,
            naamFR,
            beschrijvingFR,
            naamEN,
            beschrijvingEN,
            prijs,
            aantal,
            gewicht,
            tijd,
            temperatuur,
            ovenTemp,
            type,
            afbeeldingURL: downloadURL, // Store image URL in Firestore
            verwijderd: false // Add a flag for deletion status
          });

          progressText.innerHTML = 'Product toegevoegd';
          productAddLoading.style.display = 'none';
          document.getElementById('popupaddproduct').style.opacity = 0;
          document.getElementById('popupaddproduct').style.visibility = 'hidden';
          displayProducts();
          // Optionally, clear form fields
          document.getElementById('naamnewNL').value = '';
          document.getElementById('beschrijvingnewNL').value = '';
          document.getElementById('prijsnew').value = '';
          document.getElementById('aantalnew').value = '';
          document.getElementById('gewichtnew').value = '';
          document.getElementById('tijdnew').value = '';
          document.getElementById('temperatuurnew').value = '';
          document.getElementById('oventemperatuurnew').value = '';
          fileInput.value = '';
          progressText.innerHTML = '';
          
        }
      );
    } catch (e) {
      console.error('Error adding product: ', e);
      alert('Error adding product.');
    }
  }

  // Display products
  async function displayProducts() {
    const holderProducts = document.getElementById('holderProducts');
    const addProductBtn = document.querySelector('#addproductbtn');
    const productsLoading = document.getElementById('productsloading');

    const fragment = document.createDocumentFragment();
    
    // Show loading animation while fetching data
    productsLoading.style.display = 'block';

    try {
      const querySnapshot = await getDocs(collection(db, "Producten"));
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        if (!data.verwijderd) { // Only include products that are not marked as deleted
          const productName = data.naamNL;
          const productImage = data.afbeeldingURL;

          if (!productName || !productImage) {
            console.error(`Product data missing: ${JSON.stringify(data)}`);
          }

          const productDiv = document.createElement('div');
          productDiv.className = 'holderthumbnailproduct dashboard';
          productDiv.innerHTML = `
            <div class="shoppingcartbtn smaller" onClick="editProduct('${doc.id}', '${productName}', '${productImage}')">
                <img src="/images/editicon.svg" loading="lazy" alt="">
            </div>
            <img src="${productImage}" loading="lazy" alt="" class="thumbproductimage producten">
            <div class="thumbproductoverlay">
                <div class="mediumbold-text">${productName}</div>
                <img src="/images/deleteicon.png" loading="lazy" onClick="confirmDeleteProduct('${doc.id}', '${productName}')">
            </div>
          `;
          
          fragment.appendChild(productDiv);
        }
      });
    } catch (error) {
      console.error('Error fetching documents: ', error);
    } finally {
      // Hide loading animation after fetching data
      productsLoading.style.display = 'none';
    }

    // Clear existing product content except for the button
    holderProducts.innerHTML = '';
    if (addProductBtn) {
      holderProducts.appendChild(addProductBtn); // Re-add the button
    }
    holderProducts.appendChild(fragment); // Add new products
  }

  // Function to confirm and delete a product
  window.confirmDeleteProduct = function confirmDeleteProduct(productId, productName) {
    const confirmBox = document.getElementById('confirmDeleteBox');
    const popupDeleteProduct = document.getElementById('popupdeleteproduct');
    popupDeleteProduct.style.opacity = 1;
    popupDeleteProduct.style.visibility = 'visible';
  
    confirmBox.innerHTML = `
      <div class="confirm-delete-content">
        <p>Zeker dat u <strong>${productName}</strong> wil verwijderen?</p>
        <div class="flexholder">
          <button id="confirmDelete" class="button intypeholder notabs delete w-button">Ja, verwijder</button>
        </div>
      </div>
    `;
    
    document.getElementById('confirmDelete').onclick = function() {
      deleteProduct(productId);
      document.getElementById('popupdeleteproduct').style.opacity = 0;
      document.getElementById('popupdeleteproduct').style.visibility = "hidden";
    };

    document.getElementById('closepopupdeleteproduct').onclick = function() {
      document.getElementById('popupdeleteproduct').style.opacity = 0;
      document.getElementById('popupdeleteproduct').style.visibility = "hidden";
    };
  };

  // Function to delete a product
  window.deleteProduct = async function deleteProduct(productId) {
    try {
      const productRef = doc(db, "Producten", productId);
      await updateDoc(productRef, { verwijderd: true });
      console.log('Product marked as deleted:', productId);
      displayProducts(); // Refresh the products list after "deletion"
      document.getElementById('popupdeleteproduct').style.opacity = 0;
      document.getElementById('popupdeleteproduct').style.visibility = "hidden";
    } catch (error) {
      console.error('Error marking product as deleted: ', error);
      alert('Error marking product as deleted: ' + error.message);
    }
  };

  window.editProduct = async function editProduct(productId, productName, productImage) {
    const popupEditProduct = document.getElementById("popupeditproduct");
    popupEditProduct.style.opacity = 1;
    popupEditProduct.style.visibility = "visible";

    const productRef = doc(db, "Producten", productId);
    const productDoc = await getDoc(productRef);
    const data = productDoc.data();

    document.getElementById('editnaamNL').value = data.naamNL || '';
    document.getElementById('editbeschrijvingNL').value = data.beschrijvingNL || '';
    document.getElementById('editnaamFR').value = data.naamFR || '';
    document.getElementById('editbeschrijvingFR').value = data.beschrijvingFR || '';
    document.getElementById('editnaamEN').value = data.naamEN || '';
    document.getElementById('editbeschrijvingEN').value = data.beschrijvingEN || '';
    document.getElementById('editprijs').value = data.prijs || '';
    document.getElementById('editaantal').value = data.aantal || '';
    document.getElementById('editgewicht').value = data.gewicht || '';
    document.getElementById('edittijd').value = data.tijd || '';
    document.getElementById('edittemperatuur').value = data.temperatuur || '';
    document.getElementById('editoventemperatuur').value = data.oventemperatuur || '';
    document.getElementById('edittype').value = data.type || '';
    
    const currentImage = document.getElementById('currentImage');
    currentImage.src = productImage;
    currentImage.style.display = 'block';

    document.getElementById('editFileInput').value = ''; // Clear file input
    document.querySelector(`[editparts="1"]`).style.display = 'flex';
}

// Function to update product details
window.updateProduct = async function updateProduct() {
    const productId = document.querySelector('[editparts]:not([style*="none"])').getAttribute('data-id');
    const naamNL = document.getElementById('editnaamNL').value;
    const beschrijvingNL = document.getElementById('editbeschrijvingNL').value;
    const naamFR = document.getElementById('editnaamFR').value;
    const beschrijvingFR = document.getElementById('editbeschrijvingFR').value;
    const naamEN = document.getElementById('editnaamEN').value;
    const beschrijvingEN = document.getElementById('editbeschrijvingEN').value;
    const prijs = document.getElementById('editprijs').value;
    const aantal = document.getElementById('editaantal').value;
    const gewicht = document.getElementById('editgewicht').value;
    const tijd = document.getElementById('edittijd').value;
    const temperatuur = document.getElementById('edittemperatuur').value;
    const oventemperatuur = document.getElementById('editoventemperatuur').value;
    const type = document.getElementById('edittype').value;
    const fileInput = document.getElementById('editFileInput');
    
    let imageUrl = '';
    if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const storageRef = ref(storage, `images/${file.name}`);
        await uploadBytes(storageRef, file);
        imageUrl = await getDownloadURL(storageRef);
    }

    const productRef = doc(db, "Producten", productId);
    await updateDoc(productRef, {
        naamNL,
        beschrijvingNL,
        naamFR,
        beschrijvingFR,
        naamEN,
        beschrijvingEN,
        prijs,
        aantal,
        gewicht,
        tijd,
        temperatuur,
        oventemperatuur,
        type,
        afbeelding: imageUrl || null
    });

    // Hide popup and reset fields
    document.getElementById('popupeditproduct').style.opacity = 0;
    document.getElementById('popupeditproduct').style.visibility = "hidden";
    document.getElementById('popupeditproduct').reset();
}
</script>
<script>
  function showPart(part) {
    const parts = document.querySelectorAll('[addparts]');
    parts.forEach((el) => {
      const partNum = el.getAttribute('addparts');
      if (partNum == part) {
        el.style.display = 'flex'; // Show the current part
      } else {
        el.style.display = 'none'; // Hide all other parts
      }
    });
  }

  function validateCurrentPart(part) {
    const currentPart = document.querySelector(`[addparts="${part}"]`);
    const inputs = currentPart.querySelectorAll('input, textarea'); // Get all inputs and textareas in the current part
    let allFilled = true;

    inputs.forEach(input => {
      if (input.value.trim() === "") {
        input.style.border = "2px solid red"; // Highlight empty inputs
        allFilled = false;
      } else {
        input.style.border = ""; // Reset border if filled
      }
    });

    return allFilled;
  }

  // Event listeners for navigation and showing/hiding parts of the form
  document.getElementById("addproductbtn").addEventListener("click", function() {
    const popupAddProduct = document.getElementById("popupaddproduct");
    popupAddProduct.style.opacity = 1;
    popupAddProduct.style.visibility = "visible";
    showPart(1); // Show the first part
  });

  document.getElementById("closepopupaddproduct").addEventListener("click", function() {
    const popupAddProduct = document.getElementById("popupaddproduct");
    popupAddProduct.style.opacity = 0;
    popupAddProduct.style.visibility = "hidden";
  });

  document.querySelectorAll("[nextpart]").forEach(button => {
    button.addEventListener("click", function() {
      const currentPart = document.querySelector('[addparts]:not([style*="none"])');
      const currentPartNum = parseInt(currentPart.getAttribute('addparts'));

      if (validateCurrentPart(currentPartNum)) {
        const nextPart = currentPartNum + 1;
        showPart(nextPart);
      } else {
        alert("Please fill in all the fields before proceeding.");
      }
    });
  });

  document.querySelectorAll("[prevpart]").forEach(button => {
    button.addEventListener("click", function() {
      const currentPart = document.querySelector('[addparts]:not([style*="none"])');
      const prevPart = parseInt(currentPart.getAttribute('addparts')) - 1;
      showPart(prevPart);
    });
  });

  // Handle navigation between edit sections
document.querySelectorAll('[nexteditpart]').forEach(button => {
    button.addEventListener('click', function() {
        const currentPart = parseInt(document.querySelector('[editparts]:not(.inv)').getAttribute('editparts'));
        document.querySelector(`[editparts="${currentPart}"]`).classList.add('inv');
        document.querySelector(`[editparts="${currentPart + 1}"]`).classList.remove('inv');
    });
});

document.querySelectorAll('[preveditpart]').forEach(button => {
    button.addEventListener('click', function() {
        const currentPart = parseInt(document.querySelector('[editparts]:not(.inv)').getAttribute('editparts'));
        document.querySelector(`[editparts="${currentPart}"]`).classList.add('inv');
        document.querySelector(`[editparts="${currentPart - 1}"]`).classList.remove('inv');
    });
});

// Close edit popup
document.getElementById('closepopupeditproduct').addEventListener('click', function() {
    document.getElementById('popupeditproduct').style.opacity = 0;
    document.getElementById('popupeditproduct').style.visibility = "hidden";
});

</script>

</html>
